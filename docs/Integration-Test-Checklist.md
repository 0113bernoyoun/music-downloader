# Music Downloader - 통합 테스트 체크리스트

**생성일**: 2025-08-15  
**목적**: 주요 기능 및 Edge Case에 대한 포괄적인 통합 테스트  
**범위**: URL 검증, 메타데이터 추출, 다운로드, 에러 처리, 복구 로직

## 📋 현재 시스템 문제점 분석

### 🚨 **즉시 해결 필요한 문제들**
1. **ERR_UNHANDLED_ERROR**: Logger에서 발생하는 미처리 에러
2. **메타데이터 추출 실패**: 플레이리스트 영상 일부가 사용 불가능한 경우
3. **중복 설정 저장**: 설정 객체 내부에 중첩된 설정 구조
4. **Resume 기능 미구현**: "Resume functionality not yet implemented"
5. **불완전한 에러 복구**: 실패한 영상에 대한 스킵 로직 부족

## 🎯 핵심 기능별 통합 테스트 체크리스트

### 1. URL 검증 및 메타데이터 추출 테스트

#### 1.1 단일 동영상 URL 테스트
- [ ] **정상 YouTube URL** (`https://www.youtube.com/watch?v=VIDEO_ID`)
- [ ] **짧은 URL** (`https://youtu.be/VIDEO_ID`)
- [ ] **모바일 URL** (`https://m.youtube.com/watch?v=VIDEO_ID`)
- [ ] **YouTube Shorts** (`https://www.youtube.com/shorts/VIDEO_ID`)
- [ ] **YouTube Music** (`https://music.youtube.com/watch?v=VIDEO_ID`)

#### 1.2 플레이리스트 URL 테스트
- [ ] **정상 플레이리스트** (`https://www.youtube.com/playlist?list=PLAYLIST_ID`)
- [ ] **플레이리스트 + feature 파라미터** (`&feature=shared`)
- [ ] **플레이리스트 내 개별 영상** (`watch?v=VIDEO_ID&list=PLAYLIST_ID`)

#### 1.3 Edge Case URL 테스트
- [ ] **잘못된 URL 형식** (에러 메시지 확인)
- [ ] **존재하지 않는 동영상** (404 처리)
- [ ] **지역 제한 영상** (접근 불가 처리)
- [ ] **연령 제한 영상** (인증 필요 처리)
- [ ] **삭제된 영상** (Video unavailable 처리)

### 2. 메타데이터 추출 Edge Case 테스트

#### 2.1 개별 영상 메타데이터
- [ ] **제목에 특수문자 포함** (UTF-8, 이모지)
- [ ] **매우 긴 제목** (500자 이상)
- [ ] **제목 없는 영상** (Unknown Title 처리)
- [ ] **썸네일 없는 영상** (기본 이미지 처리)
- [ ] **메타데이터 부분 누락** (일부 필드만 있는 경우)

#### 2.2 플레이리스트 메타데이터
- [ ] **정상 플레이리스트** (모든 영상 접근 가능)
- [ ] **첫 번째 영상이 삭제된 플레이리스트**
- [ ] **중간 영상들이 삭제된 플레이리스트**
- [ ] **마지막 영상이 삭제된 플레이리스트**
- [ ] **모든 영상이 삭제된 플레이리스트**
- [ ] **빈 플레이리스트** (0개 영상)
- [ ] **매우 큰 플레이리스트** (100+ 영상)

### 3. 다운로드 기능 통합 테스트

#### 3.1 단일 영상 다운로드
- [ ] **정상 다운로드** (MP3 320kbps)
- [ ] **다양한 형식** (MP3, WAV, FLAC, AAC, OGG)
- [ ] **다양한 품질** (128kbps, 192kbps, 320kbps, best)
- [ ] **저장 경로 존재하지 않는 경우**
- [ ] **디스크 용량 부족**
- [ ] **파일명 중복 처리**

#### 3.2 플레이리스트 다운로드
- [ ] **정상 플레이리스트 전체 다운로드**
- [ ] **첫 번째 영상 실패 시 나머지 계속**
- [ ] **중간 영상 실패 시 건너뛰기**
- [ ] **부분 실패 후 전체 완료**
- [ ] **다중 동시 다운로드** (최대 3개 제한)

#### 3.3 다운로드 중단 및 재시작
- [ ] **다운로드 일시정지** (Pause)
- [ ] **다운로드 재시작** (Resume) - **현재 미구현**
- [ ] **다운로드 취소** (Cancel)
- [ ] **앱 재시작 후 복구**
- [ ] **네트워크 끊김 후 재연결**

### 4. 에러 처리 및 복구 로직 테스트

#### 4.1 네트워크 관련 에러
- [ ] **인터넷 연결 끊김**
- [ ] **DNS 해결 실패**
- [ ] **서버 타임아웃**
- [ ] **대역폭 제한**
- [ ] **YouTube API 제한**

#### 4.2 시스템 관련 에러
- [ ] **yt-dlp 바이너리 없음**
- [ ] **FFmpeg 없음**
- [ ] **권한 없는 디렉토리**
- [ ] **메모리 부족**
- [ ] **임시 파일 정리 실패**

#### 4.3 콘텐츠 관련 에러
- [ ] **저작권 보호 콘텐츠**
- [ ] **라이브 스트림**
- [ ] **프리미어 영상 (아직 공개 안됨)**
- [ ] **회원 전용 콘텐츠**
- [ ] **지역 차단 콘텐츠**

### 5. UI/UX 통합 테스트

#### 5.1 사용자 인터페이스
- [ ] **URL 입력 시 실시간 검증**
- [ ] **메타데이터 표시 정확성**
- [ ] **진행률 표시 정확성**
- [ ] **에러 메시지 사용자 친화성**
- [ ] **성공 알림 표시**

#### 5.2 상태 관리
- [ ] **다중 다운로드 상태 추적**
- [ ] **히스토리 실시간 업데이트**
- [ ] **설정 변경 즉시 반영**
- [ ] **테마 변경 즉시 적용**

## 🧪 구체적 테스트 케이스

### Test Case 1: 첫 번째 영상이 삭제된 플레이리스트
```
입력: https://www.youtube.com/playlist?list=PLP8Hc2WYsDniuoGU5dHVYDwBbmrq21DY2
기대 결과: 
- 사용 불가능한 영상은 스킵
- 다운로드 가능한 영상들만 처리
- 사용자에게 스킵된 영상 수 알림
- 전체 프로세스 계속 진행
```

### Test Case 2: 중간에 연령 제한 영상이 있는 플레이리스트
```
기대 결과:
- 연령 제한 영상은 적절한 에러 메시지와 함께 스킵
- 쿠키/인증 관련 안내 메시지 표시
- 나머지 영상 정상 다운로드 계속
```

### Test Case 3: 네트워크 불안정 상황
```
시나리오: 다운로드 중 네트워크 끊김
기대 결과:
- 적절한 재시도 로직 (exponential backoff)
- 사용자에게 네트워크 상태 알림
- 재연결 시 다운로드 재개 또는 재시작
```

### Test Case 4: 대용량 플레이리스트 (100+ 영상)
```
성능 요구사항:
- 메모리 사용량 512MB 이하 유지
- UI 응답성 유지
- 진행률 정확한 표시
- 중간 취소 가능
```

## 🔧 테스트 실행 계획

### Phase 1: 단일 기능 테스트
1. **URL 검증 테스트** (30분)
2. **메타데이터 추출 테스트** (45분)
3. **단일 영상 다운로드 테스트** (30분)

### Phase 2: 플레이리스트 테스트
1. **정상 플레이리스트 테스트** (45분)
2. **Edge Case 플레이리스트 테스트** (60분)
3. **대용량 플레이리스트 테스트** (30분)

### Phase 3: 에러 처리 테스트
1. **네트워크 에러 시뮬레이션** (45분)
2. **시스템 에러 시뮬레이션** (30분)
3. **복구 로직 검증** (45분)

### Phase 4: 성능 및 안정성 테스트
1. **장시간 다운로드 테스트** (120분)
2. **다중 동시 다운로드 테스트** (60분)
3. **메모리 누수 검사** (45분)

## 📊 성공 기준

### 기능 요구사항
- [ ] **URL 검증 정확도**: 99% 이상
- [ ] **메타데이터 추출 성공률**: 95% 이상 (유효한 영상 기준)
- [ ] **다운로드 성공률**: 90% 이상 (유효한 영상 기준)
- [ ] **에러 복구 성공률**: 80% 이상

### 성능 요구사항
- [ ] **메타데이터 추출 시간**: 개별 영상 5초 이하
- [ ] **UI 응답 시간**: 사용자 입력 후 100ms 이하
- [ ] **메모리 사용량**: 512MB 이하
- [ ] **CPU 사용률**: 평균 30% 이하

### 안정성 요구사항
- [ ] **크래시 발생률**: 0.1% 이하
- [ ] **데이터 손실**: 0%
- [ ] **설정 보존**: 100%
- [ ] **로그 기록 완전성**: 100%

## 🚀 다음 단계

1. **즉시 수정 필요**: ERR_UNHANDLED_ERROR, Resume 기능, 설정 중복
2. **우선 구현**: 플레이리스트 실패 영상 스킵 로직
3. **테스트 자동화**: CI/CD에 통합 테스트 추가
4. **모니터링**: 실제 사용자 피드백 수집

---

**테스트 실행자**: Claude Code SuperClaude  
**예상 소요시간**: 8-10시간 (자동화 포함)  
**우선순위**: P0 (즉시 실행 필요)